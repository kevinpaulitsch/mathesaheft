<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Trainer â€“ More! 1</title>

<script src="vocab.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(#eaf1ff, #ffffff);
  padding: 10px;
}
.card {
  max-width: 700px;
  margin: auto;
  background: #fff;
  padding: 20px;
  border-radius: 15px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.15);
}
h1 {
  text-align: center;
  font-size: 26px;
}
select, input, button {
  width: 100%;
  padding: 14px;
  margin-top: 10px;
  font-size: 18px;
  border-radius: 8px;
}
button {
  background: #4a7cff;
  color: white;
  border: none;
}
button.secondary {
  background: #999;
}
.correct { color: green; font-weight: bold; }
.wrong { color: red; font-weight: bold; }
.center { text-align: center; }
.stars { font-size: 24px; }
@media (max-width:600px) {
  h1 { font-size: 22px; }
  button { font-size: 16px; }
}
</style>
</head>

<body>

<div class="card">
<h1>ğŸ‡¬ğŸ‡§ English Trainer â€“ More! 1</h1>

<select id="unitSelect"></select>

<button onclick="setMode('trainer')">ğŸ“˜ Trainer</button>
<button onclick="setMode('test')">ğŸ“ Test</button>
<button onclick="setMode('gap')">âœï¸ LÃ¼ckentext</button>
<button onclick="setMode('errors')">ğŸ” Fehler Ã¼ben</button>
<button class="secondary" onclick="printTest()">ğŸ§¾ Test drucken (PDF)</button>

<hr>

<p id="question" class="center"></p>

<input id="answer" placeholder="Antwort eingeben">

<button onclick="speak()">ğŸ”Š AnhÃ¶ren</button>
<button onclick="check()">OK</button>

<p id="feedback" class="center"></p>

<p class="center">
  Punkte: <strong><span id="score">0</span></strong>
</p>

<p class="center stars" id="stars"></p>
<p class="center" id="level"></p>

</div>

<script>
let mode="trainer";
let currentUnit, words, currentWord;
let score=0, asked=0;
let wrongWords=[];

const unitSelect=document.getElementById("unitSelect");

for (let u in VOCAB) {
  let o=document.createElement("option");
  o.value=u;
  o.textContent=VOCAB[u].title;
  unitSelect.appendChild(o);
}
unitSelect.onchange=start;

function setMode(m){
  mode=m;
  score=0;
  asked=0;
  wrongWords=[];
  updateStats();
  start();
}

function start(){
  currentUnit=VOCAB[unitSelect.value];
  words=[...currentUnit.words];
  next();
}

function next(){
  document.getElementById("answer").value="";
  document.getElementById("feedback").textContent="";

  if(mode==="errors" && wrongWords.length===0){
    document.getElementById("question").textContent="ğŸ‰ Keine Fehler mehr!";
    return;
  }

  if(mode==="test" && asked===10){
    finishTest();
    return;
  }

  asked++;
  let pool=(mode==="errors")?wrongWords:words;
  currentWord=pool[Math.floor(Math.random()*pool.length)];

  document.getElementById("question").textContent =
    mode==="gap"
      ? `I like _____ (${currentWord.de})`
      : `Ãœbersetze: ${currentWord.de}`;
}

function check(){
  let a=document.getElementById("answer").value.trim().toLowerCase();
  if(a===currentWord.en.toLowerCase()){
    score++;
    document.getElementById("feedback").textContent="âœ” Richtig";
    document.getElementById("feedback").className="correct";
  } else {
    document.getElementById("feedback").textContent=
      "âœ˜ Falsch â€“ richtig: "+currentWord.en;
    document.getElementById("feedback").className="wrong";
    if(!wrongWords.includes(currentWord)) wrongWords.push(currentWord);
  }
  updateStats();
  setTimeout(next,1000);
}

function finishTest(){
  let p=Math.round((score/10)*100);
  let n=p>=90?"Sehr gut":p>=75?"Gut":p>=60?"Befriedigend":p>=50?"GenÃ¼gend":"Nicht genÃ¼gend";
  document.getElementById("question").textContent=`ğŸ“ Test beendet: ${p}% â€“ ${n}`;
}

function updateStats(){
  document.getElementById("score").textContent=score;

  let stars="â­".repeat(Math.min(5,Math.floor(score/3)));
  document.getElementById("stars").textContent=stars;

  let level = score<10?"Level 1 ğŸ£":score<25?"Level 2 ğŸ¥":score<50?"Level 3 ğŸ¦Š":"Level 4 ğŸ¦";
  document.getElementById("level").textContent=level;

  localStorage.setItem("progress_"+unitSelect.value,score);
}

function speak(){
  if(!currentWord) return;
  let u=new SpeechSynthesisUtterance(currentWord.en);
  u.lang="en-GB";
  speechSynthesis.speak(u);
}

function printTest(){
  let w=window.open("");
  w.document.write("<h1>English Test â€“ "+VOCAB[unitSelect.value].title+"</h1><ol>");
  VOCAB[unitSelect.value].words.slice(0,15).forEach(v=>{
    w.document.write(`<li>${v.de} = __________</li>`);
  });
  w.document.write("</ol>");
  w.print();
}

start();
</script>

</body>
</html>
